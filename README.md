## AstroMystic Project Documentation

### Project Overview

AstroMystic is a dynamic, full-stack web application designed to provide users with personalized astrological and tarot readings. Built with a modern tech stack, it features a React frontend, a Node.js backend, a self-hosted Jyotish (Vedic Astrology) API, and a headless CMS for blog content management.

### Key Features:

*   **Vedic Astrology Engine:**
    *   **Natal Chart (D1):** Generates a South Indian style birth chart based on user's birth date, time, and place.
    *   **Divisional Charts (Vargas):** Calculates and displays 16 essential divisional charts (including D9, D10, D2, D3, D4, etc.) for deeper analysis.
    *   **Planetary Data Table:** Provides a detailed table of planetary positions, including sign, house, nakshatra, nakshatra lord, retrograde status, and aspects.
*   **Interactive Tarot Readings:**
    *   **Multiple Spreads:** Offers various reading types like Love, Career, Personality, and Past Life.
    *   **User-Interactive Experience:** Users shuffle a virtual deck, select cards, and receive detailed, context-specific interpretations.
    *   **Custom AI-Generated Artwork:** Features a unique, cohesive Major Arcana deck with images generated by AI.
*   **Dynamic Blog:**
    *   **Headless CMS Integration:** Blog posts are managed through a user-friendly Sanity.io studio, allowing for easy content creation without code changes.
    *   **Rich Content:** Supports rich text, images, and dynamic fetching of recent posts.
*   **Modern Tech Stack:**
    *   **Frontend:** React (with Vite) for a fast, responsive user interface.
    *   **Backend:** Node.js (with Express) to handle API requests.
    *   **Astrology API:** A self-hosted, Dockerized instance of the `jyotish-api` for reliable and independent chart calculations.

---

### Getting Started

To run this project locally, you will need to start three separate services: the **Jyotish API (Docker)**, the **Backend (Node.js)**, and the **Frontend (React)**.

#### Prerequisites:

*   [Node.js](https://nodejs.org/en) (v18 or higher recommended)
*   [Docker](https://www.docker.com/products/docker-desktop/) and Docker Compose
*   A code editor (e.g., VS Code)
*   A [Sanity.io](https://www.sanity.io/) account (free tier is sufficient)
*   A Geocoding API Key (e.g., from [Geocode Maps](https://geocode.maps.co/))

#### Installation & Setup

1.  **Clone the Repository:**
    ```bash
    git clone https://github.com/Pankaj0606/AstroMystic.git
    cd AstroMystic
    ```

2.  **Set Up the Jyotish API (Docker Container):**
    This is the core astrology engine.
    ```bash
    # Navigate into the jyotish-api directory
    cd jyotish-api

    # Build and start the Docker container in the background
    docker-compose up -d

    # IMPORTANT: Run the one-time compilation command for the calculation library
    docker-compose exec jyotish_api bash -c "cd swetest/src && make clean && make && chmod 777 . && chmod +x swetest"

    # The API will now be running at http://localhost:9393
    cd .. # Go back to the root directory
    ```

3.  **Set Up the Backend (Node.js):**
    ```bash
    # Navigate into the backend directory
    cd astro-backend

    # Install dependencies
    npm install

    # Create a .env file and add your secret keys
    # Create a new file named .env
    # Add the following lines:
    # GEOCODING_API_KEY=YOUR_GEOCODING_API_KEY
    # ASTROLOGY_API_KEY=any_dummy_value_since_it_is_not_used
    # JYOTISH_API_URL=http://localhost:9393

    cd .. # Go back to the root directory
    ```

4.  **Set Up the Frontend (React):**
    ```bash
    # Navigate into the frontend directory
    cd astro-frontend

    # Install dependencies
    npm install

    # Create a .env file and add your Sanity.io project details
    # Create a new file named .env
    # Add the following lines (VITE_ prefix is required by Vite):
    # VITE_SANITY_PROJECT_ID=YOUR_SANITY_PROJECT_ID
    # VITE_SANITY_DATASET=production

    cd .. # Go back to the root directory
    ```

#### Running the Application

You will need **three separate terminal windows** open.

1.  **Terminal 1 (Jyotish API):**
    ```bash
    cd jyotish-api
    docker-compose up
    ```

2.  **Terminal 2 (Backend):**
    ```bash
    cd astro-backend
    node server.js
    ```

3.  **Terminal 3 (Frontend):**
    ```bash
    cd astro-frontend
    npm run dev
    ```

Access the application in your browser at the URL provided by Vite (usually `http://localhost:5173`).

---

### Project Structure

The project is a monorepo containing three main parts:

```
AstroMystic/
|
|-- astro-backend/      # Node.js + Express backend server
|   |-- server.js       # Main server file
|   |-- planetsRoute.js # Handles requests to the Jyotish API
|   |-- .env            # Stores backend API keys
|
|-- astro-frontend/     # React + Vite frontend application
|   |-- public/
|   |-- src/
|   |   |-- data/       # Contains the Tarot card data
|   |   |-- hooks/      # Reusable logic (e.g., useTarotDeck.js)
|   |   |-- birth/      # Components for astrology charts and tables
|   |   |-- tarotread/  # Components for Tarot readings
|   |   |-- ... (other components) ...
|   |-- vercel.json     # Configuration for Vercel deployment
|   |-- .env            # Stores frontend keys (e.g., Sanity)
|
|-- jyotish-api/        # The self-hosted Vedic Astrology API (Dockerized)
|   |-- api/            # Source code for the PHP API
|   |-- docker-compose.yml # Docker configuration
|
|-- .gitignore          # Specifies files for Git to ignore
|-- README.md           # This file
```

---

### Deployment

This project is deployed across three services:

*   **Frontend:** The `astro-frontend` is deployed as a Static Site on **Vercel**. It is configured to use the `astro-frontend` directory as its root and uses `vercel.json` to handle client-side routing.
*   **Backend:** The `astro-backend` is deployed as a Web Service on **Render**. It is configured to use the `astro-backend` directory as its root and runs the `node server.js` command.
*   **Jyotish API:** The `jyotish-api` is deployed as a Docker-based Web Service on **Render**. It is configured using its `Dockerfile` and requires a `RUN` command within the Dockerfile to compile necessary libraries.